# 3D Data Augmentation and Color Change Project

This project preprocess 3D point cloud data(.ply) and augments them for model learning. 
It includes scripts for converting PLY files to numpy arrays, 
changing colors of 3D models, 
augmenting data with SMOTE3D, 
and finally visualizing the results.

## Script Overview
### Dataprep_ply_to_numpy.py
* note: this code is not perfectly review and edited for this project.
* Purpose: Converts PLY files to numpy arrays containing the coordinates, colors, and labels of the 3D point cloud data.
* Main Functions:
  * read_plymesh(filepath): Reads a PLY file and returns a numpy array.
  * vertex_normal(coords, k=10): Computes the normal vectors for given coordinates.
  * scene_process(scene_id, split_name, mesh_path, output_path, parse_normals): Processes a PLY scene and saves it as numpy arrays.
### ColorChange.py
* Purpose: Alters the colors of the 3D point cloud data.
* Main Functions:
  * change_color(color): Changes the color based on predefined channel swapping.
  * change_color_class(): Applies the color change to the entire class.
### SMOTE3D.py
* Purpose: Augments the 3D data by generating new data points using SMOTE and applying color transformations.
* Main Functions:
  * augment_coordinates(coords): Shifts the coordinates to create new points.
  * augment_colors(colors): Modifies colors by inverting and randomizing specific channels.
  * augment_minority_class(): Augments the minority class using the SMOTE algorithm.
### visualization3d.py
* Purpose: Visualizes the original and augmented 3D point clouds.
* Main Functions:
  * visualize_ply(file_path): Displays the 3D point cloud stored in a PLY file.
  * numpy_to_ply(filename, coord_file, color_file, segment_file): Converts numpy arrays back into a PLY file.

## How to Use

### 1. Convert PLY to Numpy Arrays

To convert PLY files to numpy arrays, run the `Dataprep_ply_to_numpy.py` script. Example:
* this will extract coordination(X,Y,Z), color(G,R,B) and class(segment number) and save them separately.
 ```
 python Dataprep_ply_to_numpy.py --dataset_root <path_to_ply_files> --output_root <output_folder>
 ```


### Perform Data Augmentation with
There are 3 types of main files that are file, folder and folder plan.
To change only each segment's color of data::
 ```
python main_{type}.py --mode color
 ```

To augment the data using the SMOTE3D algorithm(for both point shift and color change, or only point shift):
 ```
python main_{type}.py --mode both
 ```

To augment the data using the SMOTE3D algorithm for coordinate augmentation only (without changing colors):
 ```
python main_{type}.py --mode both
 ```

### 3. Visualize the Data
After processing, you can visualize the original and augmented 3D point clouds:
 ```
python main.py --operation both
 ```
The visualization will open the original and the augmented data for comparison.

### 4. Option
The augmented files need to move by each model inference.
For example, Files should be placed separated in scene_id.ply folders for the Ponitcept model inference.
set folder inside the code.
The original files should be copied to destination root
<example>
source_folder = '/data/volme/data/pointcept_data/volmeda_pointcept_all/volmeda_aug' 
destination_root = '/data/volme/data/pointcept_data/volmeda_pointcept_all/volmeda_all'

 ```
python Move_augfile.py
 ```
Data split text(train.txt, val.txt, test.txt) will be generated by theses codes
For original data
 ```
data_split_trainval.py
 ```
For Augmented data
```
data_aug_split_trainval.py
 ```

The data split and place each dataset in train, eval and test folder according to plan.
 ```
Create_traineval_folder.py
 ```
